.. _checks-main:

Проверки
========

.. _checks-nginx:

Nginx
-----

Все ``server {}`` из nginx делятся на два типа: HTTP и TCP Stream, валидацию проходят только первые.

.. _checks-nginx-http:

HTTP
~~~~

Для веб-сервисов, не помеченных как промо проверятся:

0.  Определено точное доменное имя или .example.com
1.  Доступность в течение 5 секунд
2.  Просиходил ли редирект с указанного server_name куда-либо еще при обращении на ``<scheme>://server_name/``
3.  Присутствует ли в заголовках ``X-Powered-By``
4.  Присутсвуют ли дублирующиеся заголовки в ответе (только полное совпадение)
5.  Не было ли проблем с сертификатом, если подключение по https.


.. _checks-nginx-http-promo:

Promo
~~~~~

Если сервер помечен как промо (смотри :ref:`conf-nginx`), то в дополнение к обычным проверкам http добавляются следующие:

6.  Доступность и правильный mime-type:
        1.  /favicon.ico
        2.  /robots.txt
        3.  /sitemap.xml
7.  Присутствие на главной странице тегов:
        1.  ``<h1>``
        2.  ``<title>``
        3.  ``<meta name="description" ...``


HAProxy
-------

Сервисы Haproxy проверяются лишь по названию (поиск ключевых слов) или по известным портам, вследствие чего раскладываются по категориям:

*   ssh
*   sql
*   rdp
*   mail
*   http
*   ldap
*   sms


.. _checks-nic:

NIC.ru
------

Если же включено получение списка доменов с nic.ru, то к ним применяются следущие проверки:

1.  Делегирован или нет
2.  Все ли NS, указанные в зоне отвечают и знают, что они авторизованные.
3.  Присутствует ли TXT запись с v=spf1 ...
4.  Присутвует ли TXT запись с v=DMARC1 ...